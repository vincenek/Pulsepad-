<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PulsePad - Intelligent Rhythm Companion</title>
    
    <!-- PWA Manifest and Metadata -->
    <meta name="theme-color" content="#0f0e17">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBmaWxsPSIjMGYxNzJhIj48cGF0aCBkPSJNMjU2IDQ4QzE0MS4xIDQ4IDQ4IDE0MS4xIDQ4IDI1NnM5My4xIDIwOCAyMDggMjA4IDIwOC05My4xIDIwOC0yMDhTMzcwLjkgNDggMjU2IDQ4em0wIDM4NGMtOTcuMiAwLTE3Ni03OC44LTE3Ni0xNzZTMTU4LjggODAgMjU2IDgwc3E3NiA3OC44IDE3NiAxNzYtNzguOCAxNzYtMTc2IDE3NnoiLz48L3N2Zz4=">
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlB1bHNlUGFkIiwKICAic2hvcnRfbmFtZSI6ICJQdWxzZVBhZCIsCiAgInN0YXJ0X3VybCI6ICIuIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAidGhlbWVfY29sb3IiOiAiIzBmMTcyYSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzBmMTcyYSIsCiAgImljb25zIjogWwogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIWnBaWGRDYjNnOUlqQWdNQ0F6TlRBZ05UQXdJajQ4YzNSNWJHVTlJbVpoYkhObExXbHRZV2RsTFdSbGMyTnlhWEIwYVc5dUlqNDhMM04yWno0PSIsCiAgICAgICJzaXplcyI6ICIxOTJ4MTkyIiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhacFpYZENiM2c5SWpBZ01DQXpOVEFnTlRBd0lqNDhjM1I1YkdVOUltWmhiSE5sTFdsdFlXZGxMV1JsYzJOeWFYQjBhVzl1SWo0OEwzTjJaejQ9IiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfQogIF0KfQ==">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-bg: #0f0e17;
            --card-bg: rgba(255, 255, 255, 0.05);
            --text-color: #fffffe;
            --accent-1: #ff8906;
            --accent-2: #f25f4c;
            --accent-3: #e53170;
            --accent-4: #2cb67d;
            --accent-5: #7f5af0;
            --transition: all 0.5s cubic-bezier(0.22, 0.61, 0.36, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: var(--primary-bg);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
            position: relative;
            transition: background-color 0.8s ease;
        }

        .background-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 10% 20%, rgba(255, 137, 6, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(242, 95, 76, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 50% 30%, rgba(44, 182, 125, 0.1) 0%, transparent 25%);
            z-index: -1;
            opacity: 0.5;
            transition: var(--transition);
        }

        .pulse-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            overflow: hidden;
            z-index: -2;
        }

        .pulse-circle {
            position: absolute;
            border-radius: 50%;
            opacity: 0;
            animation: pulse 8s infinite cubic-bezier(0.36, 0, 0.66, -0.56);
        }

        @keyframes pulse {
            0% { transform: scale(0); opacity: 0.7; }
            100% { transform: scale(1.5); opacity: 0; }
        }

        .container {
            width: 100%;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 25px;
            z-index: 10;
        }

        .header {
            text-align: center;
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .logo {
            display: flex;
            justify-content: center;
            margin-bottom: 15px;
            position: relative;
        }

        .logo-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--accent-1);
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(255, 137, 6, 0.4);
            transition: var(--transition);
        }

        .logo-circle::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: conic-gradient(transparent, var(--accent-4), transparent);
            animation: rotate 3s linear infinite;
        }

        .logo-circle i {
            font-size: 2.5rem;
            position: relative;
            z-index: 2;
            color: #0f0e17;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--accent-1), var(--accent-2), var(--accent-3));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: -1px;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.85;
            max-width: 400px;
            line-height: 1.6;
            font-weight: 300;
        }

        .main-tabs {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50px;
            padding: 5px;
        }

        .tab-btn {
            padding: 8px 20px;
            border-radius: 50px;
            border: none;
            background: transparent;
            color: var(--text-color);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .tab-btn.active {
            background: rgba(255, 255, 255, 0.15);
        }

        .timer-card {
            width: 100%;
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            border-radius: 24px;
            padding: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.08);
            position: relative;
            overflow: hidden;
            transition: var(--transition);
        }

        .timer-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-1), var(--accent-3));
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 1s ease;
        }

        .timer-card.active::before {
            transform: scaleX(1);
        }

        .phase-display {
            font-size: 2.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: var(--transition);
            text-align: center;
        }

        .phase-description {
            font-size: 1rem;
            opacity: 0.8;
            margin-bottom: 25px;
            text-align: center;
            max-width: 300px;
            font-weight: 300;
            line-height: 1.6;
        }

        .timer-display {
            font-size: 4.5rem;
            font-weight: 200;
            font-variant-numeric: tabular-nums;
            margin-bottom: 25px;
            transition: var(--transition);
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
            font-family: 'Courier New', monospace;
            letter-spacing: -3px;
        }

        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .progress-bar {
            height: 100%;
            transition: width 1s linear;
            border-radius: 4px;
        }

        .controls {
            display: flex;
            gap: 15px;
            width: 100%;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 140px;
            justify-content: center;
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--accent-1), var(--accent-2));
            color: #0f0e17;
            font-weight: 600;
            box-shadow: 0 5px 20px rgba(255, 137, 6, 0.3);
        }

        .btn-primary:hover {
            box-shadow: 0 7px 25px rgba(255, 137, 6, 0.4);
        }

        .features {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .feature-btn {
            padding: 12px 20px;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .feature-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .feature-btn.active {
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
        }

        .rhythm-insights {
            width: 100%;
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            border-radius: 24px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.08);
            display: none;
        }

        .insights-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .insights-header h2 {
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .insight-content {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .insight-item {
            display: flex;
            gap: 15px;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            transition: var(--transition);
        }

        .insight-item:hover {
            background: rgba(255, 255, 255, 0.07);
        }

        .insight-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: linear-gradient(45deg, var(--accent-1), var(--accent-3));
            display: flex;
            justify-content: center;
            align-items: center;
            flex-shrink: 0;
        }

        .insight-text h3 {
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .insight-text p {
            font-size: 0.9rem;
            opacity: 0.8;
            line-height: 1.5;
        }

        .phase-indicators {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 20px;
        }

        .phase-indicator {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            opacity: 0.4;
            transition: var(--transition);
            cursor: pointer;
            padding: 10px;
            border-radius: 16px;
            width: 30%;
        }

        .phase-indicator.active {
            opacity: 1;
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-5px);
        }

        .phase-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.4rem;
            background: rgba(255, 255, 255, 0.1);
            transition: var(--transition);
        }

        .phase-indicator.active .phase-icon {
            background: linear-gradient(45deg, var(--accent-1), var(--accent-2));
            color: #0f0e17;
            box-shadow: 0 5px 15px rgba(255, 137, 6, 0.3);
        }

        .phase-name {
            font-size: 0.9rem;
            font-weight: 500;
            text-align: center;
        }

        .phase-time {
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .journal-container {
            width: 100%;
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            border-radius: 24px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.08);
            display: none;
        }

        .journal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .journal-header h2 {
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .journal-entry {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
            transition: var(--transition);
        }

        .journal-entry:hover {
            background: rgba(255, 255, 255, 0.07);
        }

        .journal-date {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-bottom: 10px;
        }

        .journal-content {
            font-size: 1rem;
            line-height: 1.6;
        }

        .journal-input {
            width: 100%;
            min-height: 120px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 15px;
            color: var(--text-color);
            font-size: 1rem;
            resize: vertical;
            margin-top: 15px;
        }

        .breathing-container {
            width: 100%;
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            border-radius: 24px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.08);
            display: none;
            text-align: center;
        }

        .breathing-visual {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            position: relative;
        }

        .breathing-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 3px solid var(--accent-4);
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
            transition: transform 4s ease-in-out;
        }

        .breathing-text {
            font-size: 1.5rem;
            font-weight: 500;
            position: relative;
            z-index: 2;
        }

        /* Phase-specific styles */
        .focus .phase-display {
            color: var(--accent-1);
        }
        .focus .progress-bar {
            background: linear-gradient(90deg, var(--accent-1), #ffb74d);
        }
        .focus .timer-card::before {
            background: linear-gradient(90deg, var(--accent-1), #ffb74d);
        }
        .focus .background-pattern {
            background: radial-gradient(circle at 50% 30%, rgba(255, 137, 6, 0.1) 0%, transparent 25%),
                        radial-gradient(circle at 10% 20%, rgba(255, 137, 6, 0.1) 0%, transparent 20%);
        }

        .pause .phase-display {
            color: var(--accent-4);
        }
        .pause .progress-bar {
            background: linear-gradient(90deg, var(--accent-4), #66d9a0);
        }
        .pause .timer-card::before {
            background: linear-gradient(90deg, var(--accent-4), #66d9a0);
        }
        .pause .background-pattern {
            background: radial-gradient(circle at 50% 30%, rgba(44, 182, 125, 0.1) 0%, transparent 25%),
                        radial-gradient(circle at 10% 20%, rgba(44, 182, 125, 0.1) 0%, transparent 20%);
        }

        .reflect .phase-display {
            color: var(--accent-3);
        }
        .reflect .progress-bar {
            background: linear-gradient(90deg, var(--accent-3), #f48fb1);
        }
        .reflect .timer-card::before {
            background: linear-gradient(90deg, var(--accent-3), #f48fb1);
        }
        .reflect .background-pattern {
            background: radial-gradient(circle at 50% 30%, rgba(229, 49, 112, 0.1) 0%, transparent 25%),
                        radial-gradient(circle at 10% 20%, rgba(229, 49, 112, 0.1) 0%, transparent 20%);
        }

        /* Responsive design */
        @media (max-width: 600px) {
            .timer-display {
                font-size: 3.5rem;
            }
            
            .phase-display {
                font-size: 1.8rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
            
            .header h1 {
                font-size: 2.4rem;
            }
        }

        @media (max-width: 400px) {
            .timer-display {
                font-size: 3rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .timer-card {
                padding: 20px;
            }
        }

        /* Active tab */
        .tab-content.active {
            display: block;
        }
        
        /* PWA Install Prompt */
        .install-prompt {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border-radius: 16px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 1000;
            transform: translateY(150%);
            transition: transform 0.5s ease;
            max-width: 90%;
        }
        
        .install-prompt.show {
            transform: translateY(0);
        }
        
        .install-icon {
            width: 40px;
            height: 40px;
            background: var(--accent-1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }
        
        .install-text {
            flex: 1;
            color: #333;
        }
        
        .install-text strong {
            color: #000;
        }
        
        .install-close {
            background: transparent;
            border: none;
            font-size: 20px;
            color: #888;
            cursor: pointer;
        }
        
        /* Offline Indicator */
        .offline-indicator {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--accent-2);
            color: white;
            padding: 10px 15px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 100;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            max-width: 90%;
        }
        
        .offline-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body class="focus">
    <div class="background-pattern"></div>
    <div class="pulse-effect" id="pulseEffect"></div>
    
    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-circle">
                    <i class="fas fa-wave-pulse"></i>
                </div>
            </div>
            <h1>PulsePad</h1>
            <p>Your personal rhythm companion for intentional living</p>
            
            <div class="main-tabs">
                <button class="tab-btn active" data-tab="timer">Rhythm</button>
                <button class="tab-btn" data-tab="insights">Insights</button>
                <button class="tab-btn" data-tab="journal">Journal</button>
                <button class="tab-btn" data-tab="breathing">Breathe</button>
            </div>
        </div>
        
        <!-- Timer Tab -->
        <div class="timer-card active tab-content" id="timerTab">
            <div class="phase-display">Focus</div>
            <div class="phase-description">Deep work without distractions</div>
            <div class="timer-display">40:00</div>
            
            <div class="progress-container">
                <div class="progress-bar" style="width: 100%"></div>
            </div>
            
            <div class="controls">
                <button id="startBtn" class="btn btn-primary">
                    <i class="fas fa-play"></i> Begin Flow
                </button>
                <button id="resetBtn" class="btn">
                    <i class="fas fa-redo"></i> Reset
                </button>
            </div>
            
            <div class="features">
                <div class="feature-btn" id="vibrationBtn">
                    <i class="fas fa-vibration"></i> Haptics
                </div>
                <div class="feature-btn" id="soundBtn">
                    <i class="fas fa-volume-up"></i> Sound
                </div>
                <div class="feature-btn" id="ambientBtn">
                    <i class="fas fa-music"></i> Ambience
                </div>
            </div>
        </div>
        
        <!-- Insights Tab -->
        <div class="rhythm-insights tab-content" id="insightsTab">
            <div class="insights-header">
                <h2><i class="fas fa-brain"></i> Rhythm Insights</h2>
            </div>
            <div class="insight-content">
                <div class="insight-item">
                    <div class="insight-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="insight-text">
                        <h3>Focus Patterns</h3>
                        <p>You're most productive between 9-11am. Try scheduling deep work during these hours.</p>
                    </div>
                </div>
                <div class="insight-item">
                    <div class="insight-icon">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <div class="insight-text">
                        <h3>Energy Analysis</h3>
                        <p>Your energy peaks after short breaks. Consider more frequent pauses.</p>
                    </div>
                </div>
                <div class="insight-item">
                    <div class="insight-icon">
                        <i class="fas fa-history"></i>
                    </div>
                    <div class="insight-text">
                        <h3>Rhythm History</h3>
                        <p>You've completed 42 focus cycles this week - your highest yet!</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Journal Tab -->
        <div class="journal-container tab-content" id="journalTab">
            <div class="journal-header">
                <h2><i class="fas fa-book"></i> Reflection Journal</h2>
            </div>
            
            <div class="journal-entry">
                <div class="journal-date">Today, 2:45 PM</div>
                <div class="journal-content">Felt a breakthrough on the design project during this focus session. Need to explore the gradient concept further.</div>
            </div>
            
            <div class="journal-entry">
                <div class="journal-date">Yesterday, 4:20 PM</div>
                <div class="journal-content">Realized I've been neglecting creative time. Will schedule art sessions twice this week.</div>
            </div>
            
            <textarea class="journal-input" placeholder="Add your reflection..." id="journalInput"></textarea>
            <button class="btn btn-primary" style="margin-top: 15px; width: 100%;" id="saveJournal">
                <i class="fas fa-plus"></i> Add Entry
            </button>
        </div>
        
        <!-- Breathing Tab -->
        <div class="breathing-container tab-content" id="breathingTab">
            <div class="journal-header">
                <h2><i class="fas fa-wind"></i> Breathing Exercise</h2>
            </div>
            
            <p>Follow the rhythm to center yourself and recharge</p>
            
            <div class="breathing-visual">
                <div class="breathing-circle" id="breathingCircle">
                    <div class="breathing-text" id="breathingText">Breathe In</div>
                </div>
            </div>
            
            <div class="controls">
                <button id="startBreathing" class="btn btn-primary">
                    <i class="fas fa-play"></i> Start
                </button>
            </div>
            
            <p class="phase-description" style="margin-top: 20px;">
                Inhale for 4 seconds, hold for 7, exhale for 8. Repeat 4 times.
            </p>
        </div>
        
        <div class="phase-indicators">
            <div class="phase-indicator active" data-phase="focus">
                <div class="phase-icon">
                    <i class="fas fa-bullseye"></i>
                </div>
                <div class="phase-name">Focus</div>
                <div class="phase-time">40:00</div>
            </div>
            <div class="phase-indicator" data-phase="pause">
                <div class="phase-icon">
                    <i class="fas fa-pause"></i>
                </div>
                <div class="phase-name">Pause</div>
                <div class="phase-time">10:00</div>
            </div>
            <div class="phase-indicator" data-phase="reflect">
                <div class="phase-icon">
                    <i class="fas fa-feather-alt"></i>
                </div>
                <div class="phase-name">Reflect</div>
                <div class="phase-time">05:00</div>
            </div>
        </div>
        
        <!-- Install Button -->
        <button id="installButton" class="btn" style="margin-top: 20px;">
            <i class="fas fa-download"></i> Install App
        </button>
    </div>
    
    <!-- Install Prompt -->
    <div class="install-prompt" id="installPrompt">
        <div class="install-icon">
            <i class="fas fa-download"></i>
        </div>
        <div class="install-text">
            <strong>Install PulsePad</strong>
            <p>Add to home screen for quick access</p>
        </div>
        <button class="install-close" id="closePrompt">
            <i class="fas fa-times"></i>
        </button>
    </div>
    
    <!-- Offline Indicator -->
    <div class="offline-indicator" id="offlineIndicator">
        <i class="fas fa-wifi-slash"></i>
        <span>You are currently offline</span>
    </div>

    <script>
        // Proprietary RhythmSync technology
        class RhythmSync {
            constructor() {
                this.userPatterns = JSON.parse(localStorage.getItem('pulsePadRhythm')) || {
                    focusSessions: [],
                    pauseSessions: [],
                    reflectSessions: [],
                    energyLevels: [],
                    journalEntries: []
                };
                this.optimalDurations = {
                    focus: 40 * 60,
                    pause: 10 * 60,
                    reflect: 5 * 60
                };
            }
            
            // Analyze user patterns to optimize durations
            analyzePatterns() {
                if (this.userPatterns.focusSessions.length > 3) {
                    const avgFocus = this.userPatterns.focusSessions.reduce((a, b) => a + b, 0) / 
                                   this.userPatterns.focusSessions.length;
                    this.optimalDurations.focus = Math.min(55 * 60, Math.max(25 * 60, avgFocus * 1.1));
                }
                
                if (this.userPatterns.pauseSessions.length > 3) {
                    const avgPause = this.userPatterns.pauseSessions.reduce((a, b) => a + b, 0) / 
                                   this.userPatterns.pauseSessions.length;
                    this.optimalDurations.pause = Math.min(20 * 60, Math.max(5 * 60, avgPause * 0.9));
                }
                
                this.saveToLocalStorage();
                return this.optimalDurations;
            }
            
            // Record a completed session
            recordSession(phase, duration) {
                if (phase === 'focus') {
                    this.userPatterns.focusSessions.push(duration);
                    if (this.userPatterns.focusSessions.length > 10) this.userPatterns.focusSessions.shift();
                } else if (phase === 'pause') {
                    this.userPatterns.pauseSessions.push(duration);
                    if (this.userPatterns.pauseSessions.length > 10) this.userPatterns.pauseSessions.shift();
                } else if (phase === 'reflect') {
                    this.userPatterns.reflectSessions.push(duration);
                    if (this.userPatterns.reflectSessions.length > 10) this.userPatterns.reflectSessions.shift();
                }
                
                this.saveToLocalStorage();
            }
            
            // Record energy level
            recordEnergy(level) {
                const now = new Date();
                this.userPatterns.energyLevels.push({
                    level: level,
                    timestamp: now.getTime(),
                    phase: state.currentPhase
                });
                
                if (this.userPatterns.energyLevels.length > 50) {
                    this.userPatterns.energyLevels.shift();
                }
                
                this.saveToLocalStorage();
            }
            
            // Add journal entry
            addJournalEntry(content) {
                const now = new Date();
                this.userPatterns.journalEntries.unshift({
                    content: content,
                    timestamp: now.getTime(),
                    phase: state.currentPhase
                });
                
                if (this.userPatterns.journalEntries.length > 100) {
                    this.userPatterns.journalEntries.pop();
                }
                
                this.saveToLocalStorage();
            }
            
            saveToLocalStorage() {
                localStorage.setItem('pulsePadRhythm', JSON.stringify(this.userPatterns));
            }
            
            // Generate personalized insight
            generateInsight() {
                const insights = [
                    "Your focus sessions are improving steadily. Keep it up!",
                    "Try pairing your pause time with light stretching for better results.",
                    "Your rhythm shows consistency in the morning hours.",
                    "Based on your patterns, slightly longer focus sessions might be beneficial.",
                    "Your reflection quality has increased over the past week."
                ];
                
                return insights[Math.floor(Math.random() * insights.length)];
            }
            
            // Get latest journal entries
            getJournalEntries(limit = 5) {
                return this.userPatterns.journalEntries.slice(0, limit);
            }
        }

        // App state
        const state = {
            currentPhase: 'focus',
            timeRemaining: 40 * 60,
            timerInterval: null,
            isRunning: false,
            soundEnabled: true,
            vibrationEnabled: true,
            ambientEnabled: false,
            rhythmSync: new RhythmSync(),
            breathingActive: false
        };

        // DOM Elements
        const elements = {
            body: document.body,
            phaseDisplay: document.querySelector('.phase-display'),
            phaseDescription: document.querySelector('.phase-description'),
            timerDisplay: document.querySelector('.timer-display'),
            progressBar: document.querySelector('.progress-bar'),
            startBtn: document.getElementById('startBtn'),
            resetBtn: document.getElementById('resetBtn'),
            soundBtn: document.getElementById('soundBtn'),
            vibrationBtn: document.getElementById('vibrationBtn'),
            ambientBtn: document.getElementById('ambientBtn'),
            timerCard: document.getElementById('timerCard'),
            pulseEffect: document.getElementById('pulseEffect'),
            phaseIndicators: document.querySelectorAll('.phase-indicator'),
            breathingCircle: document.getElementById('breathingCircle'),
            breathingText: document.getElementById('breathingText'),
            startBreathing: document.getElementById('startBreathing'),
            tabBtns: document.querySelectorAll('.tab-btn'),
            tabContents: document.querySelectorAll('.tab-content'),
            installButton: document.getElementById('installButton'),
            installPrompt: document.getElementById('installPrompt'),
            closePrompt: document.getElementById('closePrompt'),
            offlineIndicator: document.getElementById('offlineIndicator'),
            journalInput: document.getElementById('journalInput'),
            saveJournal: document.getElementById('saveJournal')
        };

        // Phase configurations
        const phases = {
            focus: {
                name: 'Focus',
                description: 'Deep work without distractions',
                duration: 40 * 60,
                color: '#ff8906'
            },
            pause: {
                name: 'Pause',
                description: 'Step back and recharge',
                duration: 10 * 60,
                color: '#2cb67d'
            },
            reflect: {
                name: 'Reflect',
                description: 'Process and internalize',
                duration: 5 * 60,
                color: '#e53170'
            }
        };

        // Initialize the app
        function init() {
            loadPreferences();
            updateTimerDisplay();
            setupEventListeners();
            createPulseEffects();
            updatePhaseTimes();
            loadJournalEntries();
            
            // Show initial energy prompt
            setTimeout(() => {
                showEnergyPrompt();
            }, 1000);
        }

        // Create background pulse effects
        function createPulseEffects() {
            const colors = ['#ff8906', '#e53170', '#2cb67d'];
            for (let i = 0; i < 6; i++) {
                const circle = document.createElement('div');
                circle.classList.add('pulse-circle');
                
                // Random properties
                const size = Math.random() * 100 + 50;
                const color = colors[Math.floor(Math.random() * colors.length)];
                const left = Math.random() * 100;
                const top = Math.random() * 100;
                const delay = Math.random() * 5;
                
                circle.style.width = `${size}px`;
                circle.style.height = `${size}px`;
                circle.style.background = `radial-gradient(circle, ${color}, transparent)`;
                circle.style.left = `${left}%`;
                circle.style.top = `${top}%`;
                circle.style.animationDelay = `${delay}s`;
                
                elements.pulseEffect.appendChild(circle);
            }
        }

        // Show energy level prompt
        function showEnergyPrompt() {
            if (state.isRunning) return;
            
            const energyLevel = Math.floor(Math.random() * 5) + 1; // Simulated energy reading
            
            // Create prompt
            const prompt = document.createElement('div');
            prompt.className = 'timer-card';
            prompt.style.marginTop = '20px';
            prompt.innerHTML = `
                <div style="text-align: center; padding: 20px;">
                    <h3 style="margin-bottom: 15px;"><i class="fas fa-battery-three-quarters"></i> Your Energy Level</h3>
                    <div style="display: flex; justify-content: center; gap: 10px; margin-bottom: 20px;">
                        ${[1, 2, 3, 4, 5].map(i => `
                            <div class="energy-level ${i <= energyLevel ? 'active' : ''}" 
                                 data-level="${i}" 
                                 style="width: 40px; height: 40px; border-radius: 10px; background: ${i <= energyLevel ? '#ff8906' : 'rgba(255,255,255,0.1)'}; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                            </div>
                        `).join('')}
                    </div>
                    <p style="opacity: 0.8; margin-bottom: 15px;">This helps PulsePad optimize your rhythm</p>
                </div>
            `;
            
            document.querySelector('.container').appendChild(prompt);
            
            // Add event listeners
            prompt.querySelectorAll('.energy-level').forEach(level => {
                level.addEventListener('click', () => {
                    const selectedLevel = parseInt(level.dataset.level);
                    state.rhythmSync.recordEnergy(selectedLevel);
                    prompt.style.opacity = '0';
                    setTimeout(() => prompt.remove(), 500);
                });
            });
        }

        // Load user preferences
        function loadPreferences() {
            const savedSound = localStorage.getItem('pulsePadSound');
            const savedVibration = localStorage.getItem('pulsePadVibration');
            const savedAmbient = localStorage.getItem('pulsePadAmbient');
            
            if (savedSound !== null) {
                state.soundEnabled = savedSound === 'true';
                elements.soundBtn.classList.toggle('active', state.soundEnabled);
            }
            
            if (savedVibration !== null) {
                state.vibrationEnabled = savedVibration === 'true';
                elements.vibrationBtn.classList.toggle('active', state.vibrationEnabled);
            }
            
            if (savedAmbient !== null) {
                state.ambientEnabled = savedAmbient === 'true';
                elements.ambientBtn.classList.toggle('active', state.ambientEnabled);
            }
        }

        // Set up event listeners
        function setupEventListeners() {
            // Timer controls
            elements.startBtn.addEventListener('click', toggleTimer);
            elements.resetBtn.addEventListener('click', resetTimer);
            
            // Sensory controls
            elements.soundBtn.addEventListener('click', () => {
                state.soundEnabled = !state.soundEnabled;
                elements.soundBtn.classList.toggle('active', state.soundEnabled);
                localStorage.setItem('pulsePadSound', state.soundEnabled);
                
                // Play confirmation sound
                if (state.soundEnabled) playSoftTone();
            });
            
            elements.vibrationBtn.addEventListener('click', () => {
                state.vibrationEnabled = !state.vibrationEnabled;
                elements.vibrationBtn.classList.toggle('active', state.vibrationEnabled);
                localStorage.setItem('pulsePadVibration', state.vibrationEnabled);
                
                // Trigger confirmation vibration
                if (state.vibrationEnabled && 'vibrate' in navigator) {
                    navigator.vibrate(100);
                }
            });
            
            elements.ambientBtn.addEventListener('click', () => {
                state.ambientEnabled = !state.ambientEnabled;
                elements.ambientBtn.classList.toggle('active', state.ambientEnabled);
                localStorage.setItem('pulsePadAmbient', state.ambientEnabled);
                
                // Play confirmation sound
                if (state.ambientEnabled) playAmbientSound();
            });
            
            // Phase indicators
            elements.phaseIndicators.forEach(indicator => {
                indicator.addEventListener('click', () => {
                    const phase = indicator.dataset.phase;
                    
                    // Update active indicator
                    elements.phaseIndicators.forEach(i => i.classList.remove('active'));
                    indicator.classList.add('active');
                    
                    // Update phase
                    state.currentPhase = phase;
                    state.timeRemaining = phases[phase].duration;
                    updateTimerDisplay();
                    elements.body.className = phase;
                });
            });
            
            // Tab navigation
            elements.tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Update active tab
                    elements.tabBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    // Show corresponding content
                    const tabId = btn.dataset.tab;
                    elements.tabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === tabId + 'Tab') {
                            content.classList.add('active');
                        }
                    });
                });
            });
            
            // Breathing exercise
            elements.startBreathing.addEventListener('click', toggleBreathing);
            
            // Install button
            elements.installButton.addEventListener('click', installApp);
            
            // Close install prompt
            elements.closePrompt.addEventListener('click', () => {
                elements.installPrompt.classList.remove('show');
            });
            
            // Journal save button
            elements.saveJournal.addEventListener('click', saveJournalEntry);
        }

        // Toggle timer
        function toggleTimer() {
            if (state.isRunning) {
                pauseTimer();
            } else {
                startTimer();
            }
        }

        // Start the timer
        function startTimer() {
            state.isRunning = true;
            elements.startBtn.innerHTML = '<i class="fas fa-pause"></i> Pause Flow';
            elements.timerCard.classList.add('active');
            
            // Clear any existing interval
            if (state.timerInterval) {
                clearInterval(state.timerInterval);
            }
            
            state.timerInterval = setInterval(() => {
                state.timeRemaining--;
                updateTimerDisplay();
                
                if (state.timeRemaining <= 0) {
                    nextPhase();
                }
            }, 1000);
        }

        // Pause the timer
        function pauseTimer() {
            state.isRunning = false;
            if (state.timerInterval) {
                clearInterval(state.timerInterval);
            }
            elements.startBtn.innerHTML = '<i class="fas fa-play"></i> Resume Flow';
            elements.timerCard.classList.remove('active');
        }

        // Reset the timer
        function resetTimer() {
            pauseTimer();
            state.timeRemaining = phases[state.currentPhase].duration;
            updateTimerDisplay();
        }

        // Move to next phase
        function nextPhase() {
            // Record completed session
            const completedDuration = phases[state.currentPhase].duration - state.timeRemaining;
            state.rhythmSync.recordSession(state.currentPhase, completedDuration);
            
            // Trigger sensory feedback
            triggerFeedback();
            
            // Determine next phase
            const phaseOrder = ['focus', 'pause', 'reflect'];
            const currentIndex = phaseOrder.indexOf(state.currentPhase);
            const nextIndex = (currentIndex + 1) % phaseOrder.length;
            const nextPhase = phaseOrder[nextIndex];
            
            // Update state
            state.currentPhase = nextPhase;
            state.timeRemaining = phases[nextPhase].duration;
            
            // Update UI
            updateTimerDisplay();
            elements.body.className = nextPhase;
            
            // Update active indicator
            elements.phaseIndicators.forEach(i => i.classList.remove('active'));
            document.querySelector(`[data-phase="${nextPhase}"]`).classList.add('active');
            
            // Re-apply optimized durations
            const optimized = state.rhythmSync.analyzePatterns();
            phases.focus.duration = optimized.focus;
            phases.pause.duration = optimized.pause;
            phases.reflect.duration = optimized.reflect;
            
            // Update phase times display
            updatePhaseTimes();
            
            // After reflect phase, show journal
            if (state.currentPhase === 'focus' && nextPhase === 'focus') {
                setTimeout(() => {
                    document.querySelector('.tab-btn[data-tab="journal"]').click();
                }, 500);
            }
        }

        // Toggle breathing exercise
        function toggleBreathing() {
            if (state.breathingActive) {
                stopBreathing();
            } else {
                startBreathing();
            }
        }

        // Start breathing exercise
        function startBreathing() {
            state.breathingActive = true;
            elements.startBreathing.innerHTML = '<i class="fas fa-stop"></i> Stop';
            
            let cycle = 0;
            const maxCycles = 4;
            let phase = 'inhale';
            
            function breathingCycle() {
                if (!state.breathingActive) return;
                
                if (phase === 'inhale') {
                    elements.breathingText.textContent = "Breathe In";
                    elements.breathingCircle.style.transform = "scale(1.3)";
                    phase = 'hold';
                    setTimeout(breathingCycle, 4000);
                } else if (phase === 'hold') {
                    elements.breathingText.textContent = "Hold";
                    phase = 'exhale';
                    setTimeout(breathingCycle, 7000);
                } else if (phase === 'exhale') {
                    elements.breathingText.textContent = "Breathe Out";
                    elements.breathingCircle.style.transform = "scale(1)";
                    cycle++;
                    
                    if (cycle >= maxCycles) {
                        stopBreathing();
                        return;
                    }
                    
                    phase = 'inhale';
                    setTimeout(breathingCycle, 8000);
                }
            }
            
            breathingCycle();
        }

        // Stop breathing exercise
        function stopBreathing() {
            state.breathingActive = false;
            elements.startBreathing.innerHTML = '<i class="fas fa-play"></i> Start';
            elements.breathingCircle.style.transform = "scale(1)";
            elements.breathingText.textContent = "Breathe In";
        }

        // Play ambient sound
        function playAmbientSound() {
            // In a real app, this would play actual ambient sounds
            if (state.ambientEnabled) playSoftTone();
        }

        // Trigger sensory feedback
        function triggerFeedback() {
            // Sound feedback
            if (state.soundEnabled) {
                playSoftTone();
            }
            
            // Vibration feedback
            if (state.vibrationEnabled && 'vibrate' in navigator) {
                navigator.vibrate([200, 100, 200]);
            }
            
            // Visual feedback
            animatePhaseTransition();
        }

        // Play a soft tone
        function playSoftTone() {
            const context = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = context.createOscillator();
            const gainNode = context.createGain();
            
            oscillator.type = 'sine';
            
            // Different frequencies for different phases
            if (state.currentPhase === 'focus') {
                oscillator.frequency.setValueAtTime(523.25, context.currentTime); // C5
            } else if (state.currentPhase === 'pause') {
                oscillator.frequency.setValueAtTime(392.00, context.currentTime); // G4
            } else {
                oscillator.frequency.setValueAtTime(329.63, context.currentTime); // E4
            }
            
            gainNode.gain.setValueAtTime(0.3, context.currentTime);
            
            oscillator.connect(gainNode);
            gainNode.connect(context.destination);
            
            oscillator.start();
            gainNode.gain.exponentialRampToValueAtTime(0.001, context.currentTime + 0.8);
            oscillator.stop(context.currentTime + 0.8);
        }

        // Animate phase transition
        function animatePhaseTransition() {
            elements.timerCard.animate([
                { transform: 'scale(1)', opacity: 1 },
                { transform: 'scale(0.95)', opacity: 0.7 },
                { transform: 'scale(1)', opacity: 1 }
            ], {
                duration: 500,
                easing: 'ease-out'
            });
        }

        // Update timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(state.timeRemaining / 60);
            const seconds = state.timeRemaining % 60;
            elements.timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Update progress bar
            const phaseDuration = phases[state.currentPhase].duration;
            const progress = (phaseDuration - state.timeRemaining) / phaseDuration;
            elements.progressBar.style.width = `${progress * 100}%`;
            
            // Update phase display
            elements.phaseDisplay.textContent = phases[state.currentPhase].name;
            elements.phaseDescription.textContent = phases[state.currentPhase].description;
        }

        // Update phase times display
        function updatePhaseTimes() {
            document.querySelector('[data-phase="focus"] .phase-time').textContent = 
                formatTime(phases.focus.duration);
            document.querySelector('[data-phase="pause"] .phase-time').textContent = 
                formatTime(phases.pause.duration);
            document.querySelector('[data-phase="reflect"] .phase-time').textContent = 
                formatTime(phases.reflect.duration);
        }

        // Format time for display
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            return `${minutes.toString().padStart(2, '0')}:00`;
        }
        
        // Save journal entry
        function saveJournalEntry() {
            const content = elements.journalInput.value.trim();
            if (content) {
                state.rhythmSync.addJournalEntry(content);
                loadJournalEntries();
                elements.journalInput.value = '';
                
                // Show success message
                const successMsg = document.createElement('div');
                successMsg.textContent = "Journal entry saved!";
                successMsg.style.color = "#2cb67d";
                successMsg.style.marginTop = "10px";
                successMsg.style.textAlign = "center";
                elements.saveJournal.parentNode.insertBefore(successMsg, elements.saveJournal.nextSibling);
                
                // Remove after delay
                setTimeout(() => {
                    successMsg.remove();
                }, 3000);
            }
        }
        
        // Load journal entries
        function loadJournalEntries() {
            const entriesContainer = document.querySelector('#journalTab .journal-container');
            // Clear existing entries except the input and button
            const existingEntries = entriesContainer.querySelectorAll('.journal-entry');
            existingEntries.forEach(entry => entry.remove());
            
            // Get entries and add them
            const entries = state.rhythmSync.getJournalEntries();
            entries.forEach(entry => {
                const entryEl = document.createElement('div');
                entryEl.className = 'journal-entry';
                
                const date = new Date(entry.timestamp);
                const dateStr = date.toLocaleDateString('en-US', { 
                    weekday: 'short', 
                    month: 'short', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                entryEl.innerHTML = `
                    <div class="journal-date">${dateStr}</div>
                    <div class="journal-content">${entry.content}</div>
                `;
                
                entriesContainer.insertBefore(entryEl, elements.journalInput);
            });
        }
        
        // PWA Installation Prompt
        function setupPWA() {
            const installPrompt = document.getElementById('installPrompt');
            const offlineIndicator = document.getElementById('offlineIndicator');
            
            let deferredPrompt;
            
            // Listen for beforeinstallprompt event
            window.addEventListener('beforeinstallprompt', (e) => {
                // Prevent the mini-infobar from appearing on mobile
                e.preventDefault();
                // Stash the event so it can be triggered later
                deferredPrompt = e;
                // Show the install prompt
                setTimeout(() => {
                    installPrompt.classList.add('show');
                }, 5000);
            });
            
            // Install button handler
            function installApp() {
                if (deferredPrompt) {
                    // Show the install prompt
                    deferredPrompt.prompt();
                    // Wait for the user to respond to the prompt
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('User accepted the install prompt');
                        } else {
                            console.log('User dismissed the install prompt');
                        }
                        // We no longer need the prompt. Clear it up.
                        deferredPrompt = null;
                        installPrompt.classList.remove('show');
                    });
                }
            }
            
            // Track app installed event
            window.addEventListener('appinstalled', () => {
                console.log('PulsePad was installed successfully');
                if (installPrompt) installPrompt.classList.remove('show');
            });
            
            // Offline detection
            window.addEventListener('offline', () => {
                offlineIndicator.classList.add('show');
            });
            
            window.addEventListener('online', () => {
                offlineIndicator.classList.remove('show');
            });
            
            // Initialize offline status
            if (!navigator.onLine) {
                offlineIndicator.classList.add('show');
            }
        }
        
        // Register Service Worker
        function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/sw.js').then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    }).catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
                });
            }
        }

        // Initialize the app
        window.addEventListener('DOMContentLoaded', function() {
            init();
            setupPWA();
            registerServiceWorker();
        });
    </script>
</body>
</html>